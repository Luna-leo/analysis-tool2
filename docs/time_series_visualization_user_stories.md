# User Stories — Time Series Visualization

| ID | ユーザーストーリー | DoD（完了の定義） |
|----|-------------------|-------------------|
| **US-1** | **試運転責任者として** 指定したイベント期間のデータだけをローカルに一括ダウンロードしたい **なぜなら** オフライン現地で即座に分析できるようにするため | - 期間（開始・終了）と対象イベントを UI/CLI で入力できる<br>- 対象データ量 500 MB 以内なら 5 分以内に DL 完了<br>- 進捗バーと残り時間を表示<br>- DL 後ローカル DB に自動登録され一覧に反映<br>- 範囲外データが混入していないことを自動テストで確認 |
| **US-2** | **試運転責任者として** 現地で取得した CSV/ZIP をツールに取り込みたい **なぜなら** 過去データと重ね合わせて分析するため | - ファイル選択 → DuckDB 登録ログが表示<br>- センサー重複・ファイル重複を 100 % 検出しスキップ<br>- 1 GB/セットを 10 分以内で取り込み |
| **US-3** | **試運転責任者として** 百万点規模のデータを数秒で描画したい **なぜなら** 異常判定を即行いたいから | - 100 万点の折れ線を 3 秒以内に初期描画<br>- ズーム／パン 60 fps を維持（ブラウザ計測） |
| **US-4** | **試運転責任者として** 取り込んだパラメータから X 軸・Y 軸を直感的に選び複数系列を重ね描きしたい **なぜなら** 必要な指標を即座に比較したいから | - センサ一覧からチェック／ドラッグで系列を追加・削除<br>- **軸の単位が同じでも、ユーザーが任意に第 2 Y 軸へ系列を移動できる**（自由な軸分割）<br>- 軸の単位違いを検知し自動で第 2 Y 軸を提案<br>- 設定はセッション保存され JSON エクスポートにも含まれる<br>- UI 操作 3 クリック以内で系列を追加できる |
| **US-5** | **試運転責任者として** ズーム・パン・アノテーションで分析結果を書き込めるようにしたい | - テキスト／矢印／ラインを追加・移動・削除<br>- Undo/Redo 対応<br>- 描き込み内容はセッション保存され再ロードで再現 |
| **US-6** | **試運転責任者として** グラフページの設定を JSON でエクスポート／インポートしたい **なぜなら** オフライン環境でもテンプレート共有したいから | - エクスポート JSON にレイアウト・系列・注釈を全保存<br>- インポート後 1 クリックで同一ビューを復元<br>- 互換テスト（保存→読み込み）パス率 100 % |
| **US-7** | **試運転責任者として** 発行された URL で同一グラフを Web 上で共有したい **なぜなら** リアルタイムにペア分析したいから | - 社内ネット接続時のみ URL 発行ボタン表示<br>- URL で開くと同一ビューを閲覧モードで表示<br>- アクセス権: 社内 SSO 認証／閲覧のみ・編集ありを選択 |


### 1️⃣　規模⦂S/M/L（最新版）

| ID                    | 規模    | 想定工数 (h) | 主な要素                 |
| --------------------- | ----- | -------- | -------------------- |
| **US-1** 期間指定DL＋自動登録  | **L** | **20**   | 並列DL・進捗UI・DB登録・自動テスト |
| **US-2** CSV/ZIP 取り込み | **M** | **12**   | パーサ／重複検知／ログ          |
| **US-3** 百万点高速描画      | **L** | **18**   | WebGL/Canvas最適化      |
| **US-4** 軸・系列選択 UI    | **M** | **10**   | 軸割付ロジック・UI保存         |
| **US-5** アノテーション      | **M** | **10**   | 描画ツール・Undo/Redo      |
| **US-6** JSON Ex/Im   | **S** | **4**    | シリアライズ／バリデート         |
| **US-7** URL 共有       | **M** | **8**    | 共有ビュー・SSO認証          |

**総計 ≈ 92 h**

---

### 2️⃣　MVP 優先度

| 優先度      | ストーリー                        | 理由                    |
| -------- | ---------------------------- | --------------------- |
| ★★★ 必須   | **US-2**, **US-3**, **US-4** | 現地取得→可視化の最短動線         |
| ★★☆ 望ましい | **US-1**, **US-5**           | オフラインDL と分析効率向上       |
| ★☆☆ 後続   | **US-6**, **US-7**           | 共有／テンプレート機能は MVP 後でも可 |

---

### 3️⃣　Sprint \#1（2 週間・40 h）案

| ストーリー                 | 工数   | 残キャパ   |
| --------------------- | ---- | ------ |
| **US-2** 取り込み         | 12 h | 12     |
| **US-4** 軸・系列 UI      | 10 h | 22     |
| **US-3** 高速描画（基礎表示まで） | 14 h | 36     |
| **バッファ & レビュー**       | 4 h  | **40** |

> Sprint #1 のゴール：**「現地 CSV を取り込んで即座に多系列グラフを高速描画できる」**
> ※ US-1 の期間指定DL は Sprint #2 に着手（US-2 の実装を再利用）。

---


